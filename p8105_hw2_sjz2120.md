p8105_hw2_sjz2120
================
2022-09-28

# Setup

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.2      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(readxl)
```

# Problem 1

## Data Import and Cleaning

Below we import and clean data from
`NYC_Transit_Subway_Entrance_And_Exit_Data.csv`. First we use import the
data using `read_csv()`, update variable names, and select the columns
that will be used in later in this homework. We update the variable
`entry` from `yes` / `no` to a logical variable. As part of the data
import, we specify that `Route` columns 8-11 should be character for
consistency with columns 1-7.

``` r
subway_data =
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
           col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, starts_with("route"),
         entry, exit_only, vending, entrance_type, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE ))
```

We still need to “tidy” up subway_data a bit. For instance, route number
and route should be variables, so we need to convert all of the `route`
variables from wide to long format. This will be useful when focusing on
specific routes, but may not be necessary when considering questions
that focus on station-level variables.

The following code chunk selects station name and line, and then uses
`distinct()` from `dplyr` to select only unique/distinct rows from the
data frame. As a result, the number of rows in this dataset will be
equal to the number of unique stations. We see that there are 465 unique
stations.

``` r
subway_data %>%
  select(station_name, line) %>%
  distinct
```

    ## # A tibble: 465 × 2
    ##    station_name             line    
    ##    <chr>                    <chr>   
    ##  1 25th St                  4 Avenue
    ##  2 36th St                  4 Avenue
    ##  3 45th St                  4 Avenue
    ##  4 53rd St                  4 Avenue
    ##  5 59th St                  4 Avenue
    ##  6 77th St                  4 Avenue
    ##  7 86th St                  4 Avenue
    ##  8 95th St                  4 Avenue
    ##  9 9th St                   4 Avenue
    ## 10 Atlantic Av-Barclays Ctr 4 Avenue
    ## # … with 455 more rows

In the next code chunk we now filter according to ADA compliance as an
initial step. This produces a dataframe where the number of rows is
equal to the number of ADA compliant stations. We see that there are 84
ADA compliant stations.

``` r
subway_data %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

    ## # A tibble: 84 × 2
    ##    station_name                   line           
    ##    <chr>                          <chr>          
    ##  1 Atlantic Av-Barclays Ctr       4 Avenue       
    ##  2 DeKalb Av                      4 Avenue       
    ##  3 Pacific St                     4 Avenue       
    ##  4 Grand Central                  42nd St Shuttle
    ##  5 34th St                        6 Avenue       
    ##  6 47-50th Sts Rockefeller Center 6 Avenue       
    ##  7 Church Av                      6 Avenue       
    ##  8 21st St                        63rd Street    
    ##  9 Lexington Av                   63rd Street    
    ## 10 Roosevelt Island               63rd Street    
    ## # … with 74 more rows

To compute the proportion of station entrances / exits without vending
that allow entrance, we first exclude station entrances that do not
allow vending using `filter()`. Then, we focus on the `entry` variable
using `pull()`. Since `entry` is a logical variable, we’re able to get
to the proportion we want by taking the mean of `entry` (since R will
treat logical as numeric when taking the mean). We see that the
proportion of station entrances / exits without vending that allow
entrance is 0.3770492 or about 37.70% of station entrances / exits.

``` r
subway_data %>%
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean
```

    ## [1] 0.3770492

For the last part of Question 1, we need to write a code chunk to
identify stations that serve the A train, and to assess how many of
these are ADA compliant. First, we tidy the data by converting `route`
from wide to long format. Next, we can use tools from previous parts of
the question (filtering to focus on the A train, and on ADA compliance;
selecting and using `distinct` to obtain dataframes with the required
stations in rows). We see that 60 stations serve the A train, and 17 of
these stations are ADA compliant.

``` r
subway_data %>%
    pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A") %>% 
  select(station_name, line) %>% 
  distinct
```

    ## # A tibble: 60 × 2
    ##    station_name                  line           
    ##    <chr>                         <chr>          
    ##  1 Times Square                  42nd St Shuttle
    ##  2 125th St                      8 Avenue       
    ##  3 145th St                      8 Avenue       
    ##  4 14th St                       8 Avenue       
    ##  5 168th St - Washington Heights 8 Avenue       
    ##  6 175th St                      8 Avenue       
    ##  7 181st St                      8 Avenue       
    ##  8 190th St                      8 Avenue       
    ##  9 34th St                       8 Avenue       
    ## 10 42nd St                       8 Avenue       
    ## # … with 50 more rows

``` r
subway_data %>%
    pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

    ## # A tibble: 17 × 2
    ##    station_name                  line            
    ##    <chr>                         <chr>           
    ##  1 14th St                       8 Avenue        
    ##  2 168th St - Washington Heights 8 Avenue        
    ##  3 175th St                      8 Avenue        
    ##  4 34th St                       8 Avenue        
    ##  5 42nd St                       8 Avenue        
    ##  6 59th St                       8 Avenue        
    ##  7 Inwood - 207th St             8 Avenue        
    ##  8 West 4th St                   8 Avenue        
    ##  9 World Trade Center            8 Avenue        
    ## 10 Times Square-42nd St          Broadway        
    ## 11 59th St-Columbus Circle       Broadway-7th Ave
    ## 12 Times Square                  Broadway-7th Ave
    ## 13 8th Av                        Canarsie        
    ## 14 Franklin Av                   Franklin        
    ## 15 Euclid Av                     Fulton          
    ## 16 Franklin Av                   Fulton          
    ## 17 Howard Beach                  Rockaway

# Problem 2

# Problem 3
